<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁâπË®±ÊãíÁµ∂ÁêÜÁî±ÈÄöÁü•ÂØæÊØîË°®‰ΩúÊàêAI</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* „Ç¢„Ç§„Ç≥„É≥„ÇíCSS„Åß‰ª£Êõø */
        .icon-file::before { content: "üìÑ"; }
        .icon-upload::before { content: "üìÅ"; }
        .icon-download::before { content: "üíæ"; }
        .icon-search::before { content: "üîç"; }
        .icon-check::before { content: "‚úÖ"; }
        .icon-alert::before { content: "‚ö†Ô∏è"; }
        .icon-plus::before { content: "‚ûï"; }
        .icon-trash::before { content: "üóëÔ∏è"; }
        .icon-eye::before { content: "üëÅÔ∏è"; }
        .icon-book::before { content: "üìö"; }
        .loading {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const PatentRejectionResponseAI = () => {
            const [activeTab, setActiveTab] = useState('input');
            const [inputData, setInputData] = useState({
                claims: '',
                rejectionReason: '',
                description: '',
                citations: [{ name: '', content: '' }],
                priorityClaims: '',
                synonyms: ''
            });
            const [analysisResult, setAnalysisResult] = useState(null);
            const [isAnalyzing, setIsAnalyzing] = useState(false);

            const addCitation = () => {
                setInputData(prev => ({
                    ...prev,
                    citations: [...prev.citations, { name: '', content: '' }]
                }));
            };

            const removeCitation = (index) => {
                setInputData(prev => ({
                    ...prev,
                    citations: prev.citations.filter((_, i) => i !== index)
                }));
            };

            const updateCitation = (index, field, value) => {
                setInputData(prev => ({
                    ...prev,
                    citations: prev.citations.map((citation, i) => 
                        i === index ? { ...citation, [field]: value } : citation
                    )
                }));
            };

            const handleInputChange = (field, value) => {
                setInputData(prev => ({ ...prev, [field]: value }));
            };

            const validateInput = () => {
                if (!inputData.claims.trim()) return 'ÊúÄÊñ∞„ÇØ„É¨„Éº„É†„Çª„ÉÉ„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
                if (!inputData.rejectionReason.trim()) return 'ÊãíÁµ∂ÁêÜÁî±ÈÄöÁü•(O.A.)„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
                if (inputData.citations.length === 0 || !inputData.citations[0].content.trim()) {
                    return 'Â∞ë„Å™„Åè„Å®„ÇÇ1„Å§„ÅÆÂºïÁî®ÊñáÁåÆ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
                }
                return null;
            };

            // ÊòéÁ¥∞Êõ∏ÂÆöÁæ©„ÉªÊ∏¨ÂÆöÊù°‰ª∂„ÅÆÊäΩÂá∫
            const extractDefinitionsAndConditions = (description) => {
                const definitions = [];
                
                if (!description.trim()) return definitions;
                
                // ÊòéÁ§∫ÂÆöÁæ©„ÅÆÊäΩÂá∫
                const definitionPatterns = [
                    /Êú¨ÊòéÁ¥∞Êõ∏„Å´„Åä„ÅÑ„Å¶(.+?)„ÅØ(.+?)(?:„Åß„ÅÇ„Çã|„ÇíÊÑèÂë≥„Åô„Çã|„Å®„Åô„Çã)/g,
                    /(.+?)„Å®„ÅØ(.+?)(?:„Åß„ÅÇ„Çã|„ÇíÊÑèÂë≥„Åô„Çã|„Çí„ÅÑ„ÅÜ)/g,
                    /„Äå(.+?)„Äç„ÅØ(.+?)(?:„Åß„ÅÇ„Çã|„ÇíÊÑèÂë≥„Åô„Çã|„Å®„Åô„Çã)/g
                ];
                
                definitionPatterns.forEach(pattern => {
                    let match;
                    while ((match = pattern.exec(description)) !== null) {
                        definitions.push({
                            category: 'ÊòéÁ§∫ÂÆöÁæ©',
                            term: match[1].trim(),
                            definition: match[2].trim(),
                            source: 'ÊòéÁ¥∞Êõ∏',
                            excerpt: match[0].substring(0, 80),
                            scope: 'ÂÖ®„ÇØ„É¨„Éº„É†',
                            notes: ''
                        });
                    }
                });

                // Ê∏¨ÂÆöÊù°‰ª∂„ÅÆÊäΩÂá∫
                const measurementPatterns = [
                    /(.+?)„ÅØ(.+?)„ÅßÊ∏¨ÂÆö/g,
                    /(.+?)„ÅÆÊ∏¨ÂÆö„ÅØ(.+?)„Å´„Çà„Çä/g,
                    /(.+?)Ôºö(.+?)„Å´„Çà„ÇäÊ∏¨ÂÆö/g
                ];
                
                measurementPatterns.forEach(pattern => {
                    let match;
                    while ((match = pattern.exec(description)) !== null) {
                        definitions.push({
                            category: 'Ê∏¨ÂÆöÊù°‰ª∂',
                            term: match[1].trim(),
                            definition: match[2].trim(),
                            source: 'ÊòéÁ¥∞Êõ∏',
                            excerpt: match[0].substring(0, 80),
                            scope: 'Ë©≤ÂΩìË¶ÅÁ¥†',
                            notes: '‰ªñÊñáÁåÆ„ÅØÊù°‰ª∂Á¢∫Ë™çË¶Å ‚òÖ'
                        });
                    }
                });

                return definitions;
            };

            // ‰∏ÄËá¥„Çø„Ç§„Éó„ÅÆÂà§ÂÆö
            const determineMatchType = (claimElement, citationText, exactMatch) => {
                if (exactMatch) return 'explicit';
                
                // ÂêåÁæ©Ë™û„Éª‰∏ä‰Ωç‰∏ã‰ΩçÊ¶ÇÂøµ„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ
                const synonymMap = {
                    'ÈõªÊ∞ó„Éí„Éº„Çø„Éº': ['ÁÜ±Ê∫ê', 'Âä†ÁÜ±ÊâãÊÆµ', 'Áô∫ÁÜ±‰Ωì', 'Âä†ÁÜ±Ë£ÖÁΩÆ'],
                    '„É™„ÉÅ„Ç¶„É†„Ç§„Ç™„É≥‰∫åÊ¨°ÈõªÊ±†': ['ËìÑÈõª„Éá„Éê„Ç§„Çπ', '„Éê„ÉÉ„ÉÜ„É™„Éº', 'ÈõªÊ±†', 'ËìÑÈõªÊ±†'],
                    '„Çª„É≥„Çµ': ['Ê§úÂá∫Âô®', 'ÊÑüÁü•Âô®', 'Ê∏¨ÂÆöÂô®', 'Ê§úÂá∫ÊâãÊÆµ'],
                    'Âà∂Âæ°ÈÉ®': ['Âà∂Âæ°ÊâãÊÆµ', '„Ç≥„É≥„Éà„É≠„Éº„É©', 'Âà∂Âæ°Ë£ÖÁΩÆ', 'Âà∂Âæ°ÂõûË∑Ø'],
                    '„Éù„É™„Ç®„ÉÅ„É¨„É≥': ['Ê®πËÑÇ', '„Éù„É™„Éû„Éº', 'È´òÂàÜÂ≠ê'],
                    '„Ç¢„É´„Éü„Éã„Ç¶„É†': ['ÈáëÂ±û', 'ËªΩÈáëÂ±û']
                };

                const keywords = claimElement.toLowerCase().split(/[„ÄÅ„ÄÇ\s]+/);
                for (const keyword of keywords) {
                    for (const [key, synonyms] of Object.entries(synonymMap)) {
                        if (keyword.includes(key.toLowerCase())) {
                            for (const synonym of synonyms) {
                                if (citationText.toLowerCase().includes(synonym.toLowerCase())) {
                                    return 'synonym_hypernym';
                                }
                            }
                        }
                    }
                }

                // Ê©üËÉΩÁöÑÂêåÁ≠â„ÉªÂÜÖÂú®ÁöÑË®òËºâ„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ
                const functionalKeywords = ['Ê©üËÉΩ', '‰ΩúÁî®', 'ÂäπÊûú', 'Âãï‰Ωú', '„Å´„Çà„Çä', '„Åô„Çã„Åì„Å®„Åß'];
                if (functionalKeywords.some(kw => claimElement.includes(kw))) {
                    return 'functional_inherent';
                }

                return 'explicit';
            };

            // ÁâπÊÆäÁô∫ÊòéÈ°ûÂûã„ÅÆÊ§úÂá∫
            const detectSpecialInventionTypes = (claimElement) => {
                const types = [];
                
                // Êï∞ÂÄ§ÈôêÂÆöÁô∫Êòé
                const numericalPattern = /(\d+(?:\.\d+)?)\s*([ÔΩû„Äú\-]\s*\d+(?:\.\d+)?)?\s*(‚ÑÉ|¬∞C|mm|cm|m|kg|g|mg|Œºg|ng|pg|Áßí|ÂàÜ|ÊôÇÈñì|Hz|MHz|GHz|V|mV|A|mA|ŒºA|W|mW|kW|Pa|kPa|MPa|GPa|%|ppm|ppb|mol|mmol|Œºmol|Á¥Ñ|„Åª„Åº)/g;
                if (numericalPattern.test(claimElement)) {
                    types.push('numerical');
                }

                // „Éë„É©„É°„Éº„ÇøÁô∫Êòé
                const parameterKeywords = ['ÊØîÁéá', 'Ââ≤Âêà', 'Èñ¢‰øÇ', 'Áõ∏Èñ¢', '‰øÇÊï∞', 'ÊåáÊï∞', 'ÂØÜÂ∫¶', 'Á≤òÂ∫¶', 'Á°¨Â∫¶', 'Âº∑Â∫¶', 'ÂºæÊÄßÁéá', 'Â±àÊäòÁéá', 'ÈÄèÈÅéÁéá', 'ÂèçÂ∞ÑÁéá', 'ÊØî', 'Áéá'];
                if (parameterKeywords.some(kw => claimElement.includes(kw))) {
                    types.push('parameter');
                }

                // ÈÅ∏ÊäûÁô∫Êòé
                const selectionKeywords = ['„Åã„ÇâÈÅ∏Êäû„Åï„Çå„Çã', '„Åã„Çâ„Å™„ÇãÁæ§„Çà„ÇäÈÅ∏Êäû„Åï„Çå„Çã', '„ÅÆ„ÅÑ„Åö„Çå„Åã', '‰ª•‰∏ã„Åã„ÇâÈÅ∏„Å∞„Çå„Çã', '„Åã„ÇâÈÅ∏„Å∞„Çå„Çã'];
                if (selectionKeywords.some(kw => claimElement.includes(kw))) {
                    types.push('selection');
                }

                return types;
            };

            // Ë©≥Á¥∞„Çª„Éû„É≥„ÉÜ„Ç£„ÉÉ„ÇØÊ§úÁ¥¢
            const performDetailedSemanticSearch = (claimElement, citationContent) => {
                const lines = citationContent.split('\n').map((line, index) => ({
                    content: line.trim(),
                    lineNumber: index + 1,
                    paragraphNumber: null
                }));

                // ÊÆµËêΩÁï™Âè∑„ÅÆÊäΩÂá∫
                lines.forEach(line => {
                    const paraMatch = line.content.match(/^\[(\d+)\]|^(\d+)\.|^para\s*(\d+)/);
                    if (paraMatch) {
                        line.paragraphNumber = paraMatch[1] || paraMatch[2] || paraMatch[3];
                    }
                });

                const keywords = claimElement.toLowerCase().split(/[„ÄÅ„ÄÇ\s]+/).filter(k => k.length > 1);
                let bestMatches = [];

                lines.forEach(line => {
                    if (!line.content) return;
                    
                    let score = 0;
                    let exactMatch = false;

                    // ÂÆåÂÖ®‰∏ÄËá¥„ÉÅ„Çß„ÉÉ„ÇØ
                    if (line.content.toLowerCase().includes(claimElement.toLowerCase())) {
                        score += 10;
                        exactMatch = true;
                    }

                    // „Ç≠„Éº„ÉØ„Éº„Éâ„Éû„ÉÉ„ÉÅ„É≥„Ç∞
                    keywords.forEach(keyword => {
                        if (line.content.toLowerCase().includes(keyword)) {
                            score += 2;
                        }
                    });

                    if (score > 0) {
                        const matchType = determineMatchType(claimElement, line.content, exactMatch);
                        const location = line.paragraphNumber ? 
                            `para ${line.paragraphNumber}` : 
                            `üîçline ${line.lineNumber}`;

                        bestMatches.push({
                            score,
                            location,
                            excerpt: line.content.substring(0, 80) + (line.content.length > 80 ? '...' : ''),
                            matchType,
                            exactMatch,
                            figureTable: line.content.includes('Âõ≥') || line.content.includes('Ë°®') || line.content.includes('Fig') || line.content.includes('Table') ? 
                                line.content.match(/(Âõ≥\d+|Ë°®\d+|Fig\.\s*\d+|Table\s*\d+)/)?.[0] || '' : ''
                        });
                    }
                });

                // „Çπ„Ç≥„Ç¢È†Ü„Åß„ÇΩ„Éº„Éà
                bestMatches.sort((a, b) => b.score - a.score);
                return bestMatches.slice(0, 3); // ‰∏ä‰Ωç3‰ª∂
            };

            const analyzeRejection = async () => {
                const validation = validateInput();
                if (validation) {
                    alert(validation);
                    return;
                }

                setIsAnalyzing(true);
                
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // ÂÆöÁæ©„ÉªÊ∏¨ÂÆöÊù°‰ª∂„ÅÆÂÖàÂèñ„ÇäË°®‰ΩúÊàê
                const definitions = extractDefinitionsAndConditions(inputData.description);
                
                // „ÇØ„É¨„Éº„É†Ëß£Êûê
                const claims = inputData.claims.split(/(?=„ÄêË´ãÊ±ÇÈ†Ö\d+„Äë)/).filter(c => c.trim());
                const analysisResults = claims.map((claim, claimIndex) => {
                    const claimNumber = claimIndex + 1;
                    const elements = claim.split(/[„ÄÅ„ÄÇ]/).filter(e => e.trim() && !e.includes('„ÄêË´ãÊ±ÇÈ†Ö'));
                    
                    const comparisonTable = elements.map((element, elemIndex) => {
                        const elementId = String.fromCharCode(65 + elemIndex); // A, B, C...
                        const specialTypes = detectSpecialInventionTypes(element);
                        
                        const citationAnalysis = inputData.citations.map((citation, citIndex) => {
                            const searchResults = performDetailedSemanticSearch(element, citation.content);
                            
                            let status = '‚úï';
                            let location = '‚Äî';
                            let comment = 'ÂØ©ÊüªÂÆòÊ†πÊã†Êú™ÁâπÂÆö ‚òÖ';
                            let matchType = '';
                            let excerpt = '';
                            let figureTable = '';
                            
                            if (searchResults.length > 0) {
                                const bestMatch = searchResults[0];
                                if (bestMatch.score >= 8) {
                                    status = '‚óã';
                                    comment = 'Â¶•ÂΩì';
                                } else if (bestMatch.score >= 4) {
                                    status = '‚ñ≥';
                                    comment = bestMatch.matchType === 'synonym_hypernym' ? '‰∏ä‰Ωç‰∏ã‰ΩçÊ¶ÇÂøµ„Åß„ÅÆ‰∏ÄËá¥ ‚òÖ' : 
                                             bestMatch.matchType === 'functional_inherent' ? 'Ê©üËÉΩÁöÑÂêåÁ≠â„ÉªÂÜÖÂú®ÁöÑË®òËºâ ‚òÖ' : 
                                             'ÊöóÁ§∫ÁöÑË°®Áèæ ‚òÖ';
                                }
                                
                                location = bestMatch.location;
                                matchType = bestMatch.matchType;
                                excerpt = bestMatch.excerpt;
                                figureTable = bestMatch.figureTable;
                            }
                            
                            return {
                                status,
                                location,
                                matchType,
                                excerpt,
                                figureTable,
                                comment,
                                citationName: citation.name || `ÊñáÁåÆ${citIndex + 1}`
                            };
                        });
                        
                        return {
                            elementId,
                            element: element.trim(),
                            specialTypes,
                            citations: citationAnalysis
                        };
                    });
                    
                    return {
                        claimNumber,
                        comparisonTable
                    };
                });

                setAnalysisResult({
                    claims: analysisResults,
                    definitions,
                    overallAssessment: generateOverallAssessment(analysisResults)
                });
                
                setIsAnalyzing(false);
                setActiveTab('result');
            };

            const generateOverallAssessment = (analysisResults) => {
                let totalElements = 0;
                let supportedElements = 0;
                let issueCount = 0;
                let numericalCount = 0;
                let parameterCount = 0;
                let selectionCount = 0;

                analysisResults.forEach(claim => {
                    claim.comparisonTable.forEach(row => {
                        totalElements++;
                        row.citations.forEach(cit => {
                            if (cit.status === '‚óã') supportedElements++;
                            if (cit.comment.includes('‚òÖ')) issueCount++;
                        });
                        if (row.specialTypes.includes('numerical')) numericalCount++;
                        if (row.specialTypes.includes('parameter')) parameterCount++;
                        if (row.specialTypes.includes('selection')) selectionCount++;
                    });
                });

                let assessment = `ÂØ©ÊüªÂÆòÊåáÊëò„ÇíÂèóÂÆπÂßøÂã¢„ÅßÂàÜÊûê„ÄÇ${totalElements}Ë¶ÅÁ¥†‰∏≠${supportedElements}Ë¶ÅÁ¥†„ÅßË®òËºâÁ¢∫Ë™ç„ÄÇ`;
                
                if (numericalCount > 0 || parameterCount > 0 || selectionCount > 0) {
                    assessment += `ÁâπÊÆäÁô∫ÊòéÈ°ûÂûãÔºöÊï∞ÂÄ§${numericalCount}‰ª∂„ÄÅ„Éë„É©„É°„Éº„Çø${parameterCount}‰ª∂„ÄÅÈÅ∏Êäû${selectionCount}‰ª∂„ÄÇ`;
                }
                
                if (issueCount > 0) {
                    assessment += `‚òÖË´ñÁÇπ${issueCount}‰ª∂Ë¶ÅÊ§úË®é„ÄÇ`;
                }

                return assessment;
            };

            const exportResult = () => {
                if (!analysisResult) return;
                
                let markdown = '# ÁâπË®±ÊãíÁµ∂ÁêÜÁî±ÈÄöÁü•ÂøúÁ≠î - „ÇØ„É¨„Éº„É†ÂØæÊØîË°®\n\n';
                
                // ÂÆöÁæ©„ÉªÊ∏¨ÂÆöÊù°‰ª∂Ë°®
                if (analysisResult.definitions.length > 0) {
                    markdown += '## ÂÖàÂèñ„ÇäË°®ÔºöÂÆöÁæ©Ë™û„ÉªÊ∏¨ÂÆöÊù°‰ª∂ÔºàÊòéÁ¥∞Êõ∏„Éô„Éº„ÇπÔºâ\n\n';
                    markdown += '| Âå∫ÂàÜ | Áî®Ë™û/„Éë„É©„É°„Éº„Çø | ÂÆöÁæ©/Ê∏¨ÂÆöÊù°‰ª∂ | Ê†πÊã†ÁÆáÊâÄ | ÊäúÁ≤ãÔºà‚â§80Â≠óÔºâ | ÈÅ©Áî®ÁØÑÂõ≤ | Ê≥®ÊÑè(‚òÖ) |\n';
                    markdown += '|------|----------------|--------------|----------|---------------|----------|----------|\n';
                    
                    analysisResult.definitions.forEach(def => {
                        markdown += `| ${def.category} | ${def.term} | ${def.definition} | ${def.source} | ${def.excerpt} | ${def.scope} | ${def.notes} |\n`;
                    });
                    markdown += '\n';
                }
                
                // „ÇØ„É¨„Éº„É†ÂØæÊØîË°®
                analysisResult.claims.forEach(claim => {
                    markdown += `## Claim ${claim.claimNumber} ÂØæÊØîË°®\n\n`;
                    markdown += '| Ë¶ÅÁ¥†ID | „ÇØ„É¨„Éº„É†Êñá | ÊñáÁåÆ | ÊúâÁÑ° | ÁÆáÊâÄ | ‰∏ÄËá¥„Çø„Ç§„Éó | ÊäúÁ≤ãÔºà‚â§80Â≠óÔºâ | Âõ≥/Ë°® | „Ç≥„É°„É≥„Éà |\n';
                    markdown += '|--------|-----------|------|------|------|-----------|---------------|-------|----------|\n';
                    
                    claim.comparisonTable.forEach(row => {
                        row.citations.forEach((cit, citIndex) => {
                            const matchTypeMap = {
                                'explicit': 'ÊòéÁ§∫',
                                'synonym_hypernym': 'ÂêåÁæ©Ôºè‰∏ä‰Ωç‰∏ã‰Ωç',
                                'functional_inherent': 'Ê©üËÉΩÁöÑÂêåÁ≠â„ÉªÂÜÖÂú®'
                            };
                            
                            markdown += `| ${row.elementId} | ${row.element} | ${cit.citationName} | ${cit.status} | ${cit.location} | ${matchTypeMap[cit.matchType] || '‚Äî'} | ${cit.excerpt || '‚Äî'} | ${cit.figureTable || '‚Äî'} | ${cit.comment} |\n`;
                        });
                    });
                    markdown += '\n';
                });
                
                markdown += `**ÂÖ®‰ΩìÁ∑èË©ïÔºà‚â§100Â≠óÔºâ**\n${analysisResult.overallAssessment}\n\n`;
                markdown += '---\n';
                markdown += '„ÉÅ„É£„Éº„Éà„Å´„Å§„ÅÑ„Å¶ **‰øÆÊ≠£„ÉªËøΩË£ú„ÅÆ„ÅîË¶ÅÊúõ„ÅØ„ÅÇ„Çä„Åæ„Åô„ÅãÔºü**\n';
                markdown += '„Åæ„Åü **ÂøúÁ≠îÊ°àÔºàË£úÊ≠£Ê°àÔºãÂèçË´ñÊñáÔºâ„ÅÆ‰ΩúÊàê„Çí„ÅîÂ∏åÊúõ„Åß„Åô„ÅãÔºü**\n';
                
                const blob = new Blob([markdown], { type: 'text/markdown' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'patent_rejection_analysis.md';
                a.click();
                URL.revokeObjectURL(url);
            };

            const getMatchTypeIcon = (matchType) => {
                switch (matchType) {
                    case 'explicit': return '‚úì';
                    case 'synonym_hypernym': return '‚âà';
                    case 'functional_inherent': return '‚ö°';
                    default: return '';
                }
            };

            const getMatchTypeLabel = (matchType) => {
                switch (matchType) {
                    case 'explicit': return 'ÊòéÁ§∫';
                    case 'synonym_hypernym': return 'ÂêåÁæ©Ôºè‰∏ä‰Ωç‰∏ã‰Ωç';
                    case 'functional_inherent': return 'Ê©üËÉΩÁöÑÂêåÁ≠â„ÉªÂÜÖÂú®';
                    default: return '‚Äî';
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
                    <div className="max-w-7xl mx-auto">
                        <header className="text-center mb-8">
                            <div className="flex items-center justify-center gap-3 mb-4">
                                <span className="icon-file text-4xl"></span>
                                <h1 className="text-3xl font-bold text-gray-800">ÂØæÊØîË°®‰ΩúÊàêÔºàÊãíÁµ∂ÁêÜÁî±ÈÄöÁü•Ê§úË®éÁî®ÔºâAI</h1>
                            </div>
                            <p className="text-gray-600">ÂèóÂÆπÂßøÂã¢„Å´„Çà„ÇãÊ§úË®ºÂèØËÉΩ„Å™Ê†πÊã†‰ªò„Åç„ÇØ„É¨„Éº„É†ÂØæÊØîË°®‰ΩúÊàê„Ç∑„Çπ„ÉÜ„É†</p>
                        </header>

                        <div className="bg-white rounded-xl shadow-lg overflow-hidden">
                            <div className="flex border-b">
                                <button
                                    onClick={() => setActiveTab('input')}
                                    className={`flex-1 px-6 py-4 font-medium transition-colors cursor-pointer ${
                                        activeTab === 'input' ? 'bg-indigo-50 text-indigo-600 border-b-2 border-indigo-600' : 'text-gray-500 hover:text-gray-700 hover:bg-gray-50'
                                    }`}
                                >
                                    <span className="icon-upload mr-2"></span>
                                    ÊÉÖÂ†±ÂÖ•Âäõ
                                </button>
                                <button
                                    onClick={() => analysisResult ? setActiveTab('result') : null}
                                    className={`flex-1 px-6 py-4 font-medium transition-colors ${
                                        activeTab === 'result' ? 'bg-indigo-50 text-indigo-600 border-b-2 border-indigo-600' : 
                                        analysisResult ? 'text-gray-500 hover:text-gray-700 hover:bg-gray-50 cursor-pointer' : 'text-gray-300 cursor-not-allowed'
                                    }`}
                                    disabled={!analysisResult}
                                >
                                    <span className="icon-eye mr-2"></span>
                                    ‰ΩúÊàêÁµêÊûú
                                </button>
                            </div>

                            {activeTab === 'input' && (
                                <div className="p-6 space-y-6">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            ÊúÄÊñ∞„ÇØ„É¨„Éº„É†„Çª„ÉÉ„ÉàÔºàÂÖ®ÊñáÔºâ <span className="text-red-500">*</span>
                                        </label>
                                        <textarea
                                            value={inputData.claims}
                                            onChange={(e) => handleInputChange('claims', e.target.value)}
                                            className="w-full h-32 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                            placeholder="„ÄêË´ãÊ±ÇÈ†Ö1„Äë„Äú„ÅÆÊßãÊàê„ÇíÂÇô„Åà„ÇãË£ÖÁΩÆ„ÄÇ&#10;„ÄêË´ãÊ±ÇÈ†Ö2„ÄëË´ãÊ±ÇÈ†Ö1„Å´Ë®òËºâ„ÅÆË£ÖÁΩÆ„Åß„ÅÇ„Å£„Å¶„ÄÅ„Åï„Çâ„Å´„Äú"
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            ÊãíÁµ∂ÁêÜÁî±ÈÄöÁü•(O.A.) <span className="text-red-500">*</span>
                                        </label>
                                        <textarea
                                            value={inputData.rejectionReason}
                                            onChange={(e) => handleInputChange('rejectionReason', e.target.value)}
                                            className="w-full h-24 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                            placeholder="Ë´ãÊ±ÇÈ†Ö1„ÅØÂºïÁî®ÊñáÁåÆA„ÅÆÊÆµËêΩ15„Å´Ë®òËºâ„Åï„Çå„Åü„Äú„Å´„Çà„ÇäÊñ∞Ë¶èÊÄß„ÇíÊ¨†„Åè..."
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">
                                            ÊòéÁ¥∞Êõ∏ÔºàdescriptionÔºâ- Ë´ãÊ±ÇÈ†Ö„ÇíÈô§„ÅèÊú¨Êñá <span className="text-gray-400">Ôºà‰ªªÊÑèÔºâ</span>
                                        </label>
                                        <textarea
                                            value={inputData.description}
                                            onChange={(e) => handleInputChange('description', e.target.value)}
                                            className="w-full h-24 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                            placeholder="Êú¨ÊòéÁ¥∞Êõ∏„Å´„Åä„ÅÑ„Å¶‚óã‚óã„ÅØ...&#10;Á≤òÂ∫¶„ÅØBrookfield LV, #4, 60 rpm, 25¬∞C„ÅßÊ∏¨ÂÆö..."
                                        />
                                        <p className="text-xs text-gray-500 mt-1">
                                            <span className="icon-book mr-1"></span>
                                            ÂÆöÁæ©Ë™û„ÉªÊ∏¨ÂÆöÊù°‰ª∂„ÅÆËá™ÂãïÊäΩÂá∫„Å´‰ΩøÁî®„Åï„Çå„Åæ„Åô
                                        </p>
                                    </div>

                                    <div>
                                        <div className="flex items-center justify-between mb-2">
                                            <label className="block text-sm font-medium text-gray-700">
                                                ÂºïÁî®ÊñáÁåÆÔºàÂÖ®ÊñáÔºâ <span className="text-red-500">*</span>
                                            </label>
                                            <button
                                                onClick={addCitation}
                                                className="flex items-center gap-1 px-3 py-1 bg-indigo-100 text-indigo-600 rounded-md hover:bg-indigo-200 transition-colors"
                                            >
                                                <span className="icon-plus"></span>
                                                ÊñáÁåÆËøΩÂä†
                                            </button>
                                        </div>
                                        {inputData.citations.map((citation, index) => (
                                            <div key={index} className="mb-4 p-4 border border-gray-200 rounded-lg">
                                                <div className="flex items-center gap-2 mb-3">
                                                    <input
                                                        type="text"
                                                        value={citation.name}
                                                        onChange={(e) => updateCitation(index, 'name', e.target.value)}
                                                        className="flex-1 p-2 border border-gray-300 rounded focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                                        placeholder={`ÊñáÁåÆ${index + 1}„ÅÆÂêçÁß∞Ôºà‰æãÔºöÁâπÈñã2020-123456Âè∑ÂÖ¨Â†±Ôºâ`}
                                                    />
                                                    {inputData.citations.length > 1 && (
                                                        <button
                                                            onClick={() => removeCitation(index)}
                                                            className="p-2 text-red-500 hover:bg-red-50 rounded"
                                                        >
                                                            <span className="icon-trash"></span>
                                                        </button>
                                                    )}
                                                </div>
                                                <textarea
                                                    value={citation.content}
                                                    onChange={(e) => updateCitation(index, 'content', e.target.value)}
                                                    className="w-full h-32 p-3 border border-gray-300 rounded focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                                    placeholder="ÊñáÁåÆ„ÅÆÂÖ®Êñá„Åæ„Åü„ÅØOCR„ÉÜ„Ç≠„Çπ„ÉàÔºàÊÆµËêΩÁï™Âè∑„ÉªË°åÁï™Âè∑Êé®Â•®Ôºâ&#10;[0015] Êú¨ÂÆüÊñΩÂΩ¢ÊÖã„Åß„ÅØ...&#10;[0016] „Åï„Çâ„Å´...&#10;Âõ≥Èù¢„ÉªË°®„ÉªËÑöÊ≥®„ÇÇÂê´„ÇÄ"
                                                />
                                                <p className="text-xs text-gray-500 mt-1">ÊÆµËêΩÁï™Âè∑„ÄÅÂõ≥Èù¢„ÄÅË°®„ÄÅ„Ç≠„É£„Éó„Ç∑„Éß„É≥„ÄÅËÑöÊ≥®„ÇÇÊ§úÁ¥¢ÂØæË±°„Å®„Å™„Çä„Åæ„Åô</p>
                                            </div>
                                        ))}
                                    </div>

                                    <div className="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">
                                                ÂÑ™ÂÖà„É¨„Éì„É•„ÉºË´ãÊ±ÇÈ†Ö <span className="text-gray-400">Ôºà‰ªªÊÑèÔºâ</span>
                                            </label>
                                            <input
                                                type="text"
                                                value={inputData.priorityClaims}
                                                onChange={(e) => handleInputChange('priorityClaims', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                                placeholder="‰æãÔºö1, 3, 5"
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">
                                                ÂàÜÈáéÂõ∫Êúâ„ÅÆÂêåÁæ©Ë™û„ÉªÁΩÆÊèõË™û„É™„Çπ„Éà <span className="text-gray-400">Ôºà‰ªªÊÑèÔºâ</span>
                                            </label>
                                            <textarea
                                                value={inputData.synonyms}
                                                onChange={(e) => handleInputChange('synonyms', e.target.value)}
                                                className="w-full h-20 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                                placeholder="ÈõªÊ∞ó„Éí„Éº„Çø„Éº=ÁÜ±Ê∫ê=Âä†ÁÜ±ÊâãÊÆµ&#10;„Çª„É≥„Çµ=Ê§úÂá∫Âô®=ÊÑüÁü•Âô®"
                                            />
                                        </div>
                                    </div>

                                    <div className="flex justify-end">
                                        <button
                                            onClick={analyzeRejection}
                                            disabled={isAnalyzing}
                                            className={`px-8 py-3 rounded-lg font-medium transition-colors ${
                                                isAnalyzing
                                                    ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                                    : 'bg-indigo-600 text-white hover:bg-indigo-700'
                                            }`}
                                        >
                                            {isAnalyzing ? (
                                                <>
                                                    <div className="loading w-5 h-5 border-2 border-white border-t-transparent rounded-full inline-block mr-2"></div>
                                                    ÂàÜÊûê‰∏≠...
                                                </>
                                            ) : (
                                                <>
                                                    <span className="icon-search mr-2"></span>
                                                    „ÇØ„É¨„Éº„É†ÂØæÊØîË°®„Çí‰ΩúÊàê
                                                </>
                                            )}
                                        </button>
                                    </div>
                                </div>
                            )}

                            {activeTab === 'result' && analysisResult && (
                                <div className="p-6">
                                    <div className="flex justify-between items-center mb-6">
                                        <h2 className="text-2xl font-bold text-gray-800">‰ΩúÊàêÁµêÊûú</h2>
                                        <button
                                            onClick={exportResult}
                                            className="flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
                                        >
                                            <span className="icon-download"></span>
                                            MarkdownÂá∫Âäõ
                                        </button>
                                    </div>

                                    {/* ÂÆöÁæ©„ÉªÊ∏¨ÂÆöÊù°‰ª∂Ë°® */}
                                    {analysisResult.definitions.length > 0 && (
                                        <div className="mb-8">
                                            <h3 className="text-xl font-semibold mb-4 text-purple-600">
                                                üìã ÂÖàÂèñ„ÇäË°®ÔºöÂÆöÁæ©Ë™û„ÉªÊ∏¨ÂÆöÊù°‰ª∂ÔºàÊòéÁ¥∞Êõ∏„Éô„Éº„ÇπÔºâ
                                            </h3>
                                            <div className="overflow-x-auto">
                                                <table className="w-full border border-gray-300 rounded-lg overflow-hidden text-sm">
                                                    <thead className="bg-purple-50">
                                                        <tr>
                                                            <th className="p-2 text-left border-r border-gray-300 font-medium">Âå∫ÂàÜ</th>
                                                            <th className="p-2 text-left border-r border-gray-300 font-medium">Áî®Ë™û/„Éë„É©„É°„Éº„Çø</th>
                                                            <th className="p-2 text-left border-r border-gray-300 font-medium">ÂÆöÁæ©/Ê∏¨ÂÆöÊù°‰ª∂</th>
                                                            <th className="p-2 text-left border-r border-gray-300 font-medium">Ê†πÊã†ÁÆáÊâÄ</th>
                                                            <th className="p-2 text-left border-r border-gray-300 font-medium">ÊäúÁ≤ãÔºà‚â§80Â≠óÔºâ</th>
                                                            <th className="p-2 text-left border-r border-gray-300 font-medium">ÈÅ©Áî®ÁØÑÂõ≤</th>
                                                            <th className="p-2 text-left font-medium">Ê≥®ÊÑè(‚òÖ)</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {analysisResult.definitions.map((def, index) => (
                                                            <tr key={index} className={index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                                                <td className="p-2 border-r border-gray-300 font-medium">{def.category}</td>
                                                                <td className="p-2 border-r border-gray-300">{def.term}</td>
                                                                <td className="p-2 border-r border-gray-300">{def.definition}</td>
                                                                <td className="p-2 border-r border-gray-300">{def.source}</td>
                                                                <td className="p-2 border-r border-gray-300 text-xs">{def.excerpt}</td>
                                                                <td className="p-2 border-r border-gray-300">{def.scope}</td>
                                                                <td className="p-2">{def.notes}</td>
                                                            </tr>
                                                        ))}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    )}

                                    {/* „ÇØ„É¨„Éº„É†ÂØæÊØîË°® */}
                                    {analysisResult.claims.map(claim => (
                                        <div key={claim.claimNumber} className="mb-8">
                                            <h3 className="text-xl font-semibold mb-4 text-indigo-600">
                                                Claim {claim.claimNumber} ÂØæÊØîË°®
                                            </h3>
                                            
                                            <div className="overflow-x-auto">
                                                <table className="w-full border border-gray-300 rounded-lg overflow-hidden text-sm">
                                                    <thead className="bg-gray-50">
                                                        <tr>
                                                            <th className="p-2 text-left border-r border-gray-300 font-medium">Ë¶ÅÁ¥†ID</th>
                                                            <th className="p-2 text-left border-r border-gray-300 font-medium">„ÇØ„É¨„Éº„É†Êñá</th>
                                                            <th className="p-2 text-center border-r border-gray-300 font-medium">ÊñáÁåÆ</th>
                                                            <th className="p-2 text-center border-r border-gray-300 font-medium">ÊúâÁÑ°</th>
                                                            <th className="p-2 text-center border-r border-gray-300 font-medium">ÁÆáÊâÄ</th>
                                                            <th className="p-2 text-center border-r border-gray-300 font-medium">‰∏ÄËá¥„Çø„Ç§„Éó</th>
                                                            <th className="p-2 text-center border-r border-gray-300 font-medium">ÊäúÁ≤ãÔºà‚â§80Â≠óÔºâ</th>
                                                            <th className="p-2 text-center border-r border-gray-300 font-medium">Âõ≥/Ë°®</th>
                                                            <th className="p-2 text-center font-medium">„Ç≥„É°„É≥„Éà</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        {claim.comparisonTable.map((row, rowIndex) => (
                                                            row.citations.map((cit, citIndex) => (
                                                                <tr key={`${rowIndex}-${citIndex}`} className={rowIndex % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>
                                                                    {citIndex === 0 && (
                                                                        <>
                                                                            <td className="p-2 border-r border-gray-300 font-bold text-center" rowSpan={row.citations.length}>
                                                                                {row.elementId}
                                                                                {row.specialTypes.length > 0 && (
                                                                                    <div className="mt-1">
                                                                                        {row.specialTypes.includes('numerical') && <span className="inline-block bg-purple-100 text-purple-600 text-xs px-1 rounded mr-1">Êï∞ÂÄ§</span>}
                                                                                        {row.specialTypes.includes('parameter') && <span className="inline-block bg-green-100 text-green-600 text-xs px-1 rounded mr-1">„Éë„É©„É°„Éº„Çø</span>}
                                                                                        {row.specialTypes.includes('selection') && <span className="inline-block bg-orange-100 text-orange-600 text-xs px-1 rounded">ÈÅ∏Êäû</span>}
                                                                                    </div>
                                                                                )}
                                                                            </td>
                                                                            <td className="p-2 border-r border-gray-300" rowSpan={row.citations.length}>
                                                                                {row.element}
                                                                            </td>
                                                                        </>
                                                                    )}
                                                                    <td className="p-2 border-r border-gray-300 text-center font-medium">
                                                                        {cit.citationName}
                                                                    </td>
                                                                    <td className="p-2 border-r border-gray-300 text-center">
                                                                        <span className={`inline-flex items-center justify-center w-6 h-6 rounded-full text-sm font-bold ${
                                                                            cit.status === '‚óã' ? 'bg-green-100 text-green-600' :
                                                                            cit.status === '‚ñ≥' ? 'bg-yellow-100 text-yellow-600' :
                                                                            'bg-red-100 text-red-600'
                                                                        }`}>
                                                                            {cit.status}
                                                                        </span>
                                                                    </td>
                                                                    <td className="p-2 border-r border-gray-300 text-center">
                                                                        {cit.location}
                                                                    </td>
                                                                    <td className="p-2 border-r border-gray-300 text-center">
                                                                        <div className="flex items-center justify-center gap-1">
                                                                            <span className="text-lg">{getMatchTypeIcon(cit.matchType)}</span>
                                                                            <span className="text-xs">{getMatchTypeLabel(cit.matchType)}</span>
                                                                        </div>
                                                                    </td>
                                                                    <td className="p-2 border-r border-gray-300 text-xs">
                                                                        {cit.excerpt || '‚Äî'}
                                                                    </td>
                                                                    <td className="p-2 border-r border-gray-300 text-center text-xs">
                                                                        {cit.figureTable || '‚Äî'}
                                                                    </td>
                                                                    <td className="p-2">
                                                                        <div className="flex items-center gap-1">
                                                                            {cit.comment.includes('‚òÖ') ? (
                                                                                <span className="icon-alert text-orange-500 flex-shrink-0"></span>
                                                                            ) : (
                                                                                <span className="icon-check text-green-500 flex-shrink-0"></span>
                                                                            )}
                                                                            <span className="text-xs">{cit.comment}</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            ))
                                                        ))}
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    ))}

                                    {/* ÂÖ®‰ΩìÁ∑èË©ï */}
                                    <div className="mt-8 p-4 bg-blue-50 rounded-lg">
                                        <h4 className="font-semibold text-blue-800 mb-2">ÂÖ®‰ΩìÁ∑èË©ïÔºà‚â§100Â≠óÔºâ</h4>
                                        <p className="text-blue-700">{analysisResult.overallAssessment}</p>
                                    </div>

                                    {/* „É¶„Éº„Ç∂Á¢∫Ë™ç */}
                                    <div className="mt-8 p-4 bg-yellow-50 rounded-lg border-l-4 border-yellow-400">
                                        <p className="text-yellow-800">
                                            „ÉÅ„É£„Éº„Éà„Å´„Å§„ÅÑ„Å¶ <strong>‰øÆÊ≠£„ÉªËøΩË£ú„ÅÆ„ÅîË¶ÅÊúõ„ÅØ„ÅÇ„Çä„Åæ„Åô„ÅãÔºü</strong><br />
                                            „Åæ„Åü <strong>ÂøúÁ≠îÊ°àÔºàË£úÊ≠£Ê°àÔºãÂèçË´ñÊñáÔºâ„ÅÆ‰ΩúÊàê„Çí„ÅîÂ∏åÊúõ„Åß„Åô„ÅãÔºü</strong>
                                        </p>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<PatentRejectionResponseAI />, document.getElementById('root'));
    </script>
</body>
</html>
